<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Review Llama</title>

    <link rel="shortcut icon" href="../media/kuzco_cursed.png">
    
    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="//code.jquery.com/ui/1.11.2/themes/smoothness/jquery-ui.css">
    <link href="../bower_components/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- MetisMenu CSS -->
    <link href="../bower_components/metisMenu/dist/metisMenu.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="../css/sb-admin-2.css" rel="stylesheet">

    <!-- Custom Fonts -->
    <link href="../bower_components/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">

    <link href="../css/main.css" rel="stylesheet">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>

<body>

    <div id="wrapper">

        <!-- Navigation -->
        <nav class="navbar navbar-default navbar-static-top" role="navigation" style="margin-bottom: 0">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="dashboard.html">Review Llama</a>
            </div>
            <!-- /.navbar-header -->

            <ul class="nav navbar-top-links navbar-right">
                <li class="dropdown">
                    <a class="dropdown-toggle" data-toggle="dropdown" href="#">
                        <i class="fa fa-user fa-fw"></i>  <i class="fa fa-caret-down"></i>
                    </a>
                    <ul class="dropdown-menu dropdown-user">
                        <li><a href="#"><i class="fa fa-user fa-fw"></i> User Profile</a>
                        </li>
                        <li><a href="#"><i class="fa fa-cog fa-spin"></i> Settings</a>
                        </li>
                        <li class="divider"></li>
                        <li><a href="../login.html"><i class="fa fa-sign-out fa-fw"></i> Logout</a>
                        </li>
                    </ul>
                    <!-- /.dropdown-user -->
                </li>
                <!-- /.dropdown -->
            </ul>
            <!-- /.navbar-top-links -->

            <div class="navbar-default sidebar" role="navigation">
                <div class="sidebar-nav navbar-collapse">
                    <ul class="nav" id="side-menu">
                        <li>
                            <a href="dashboard.html"><i class="fa fa-dashboard fa-fw"></i> Dashboard</a>
                        </li>
                        <li>
                            <a href="report.html"><i class="fa fa-file fa-fw"></i> My Report</a>
                        </li>
                        <li>
                            <a href="assessments.html"><i class="fa fa-edit fa-fw"></i> My Assessments</a>
                        </li>
                        <li>
                            <a href="marks.html"><i class="fa fa-calculator fa-fw"></i> My Marks</a>
                        </li>
                        <li>
                            <a href="../forum.html"><i class="fa fa-users fa-fw"></i> Da Forum</a>
                        </li>
                    </ul>
                </div>
                <!-- /.sidebar-collapse -->
            </div>
            <!-- /.navbar-static-side -->
        </nav>

        <!-- Page Content -->
        <div id="page-wrapper">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-lg-12">
                        <h1 class="page-header">My Assessments</h1>
                    </div>
                    <!-- /.col-lg-12 -->
                </div>
                <!-- /.row -->
            </div>
            <!-- /.container-fluid -->
        </div>
        <!-- /#page-wrapper -->

    </div>
    <!-- /#wrapper -->

    <!-- jQuery -->
    <script src="//code.jquery.com/jquery-1.10.2.js"></script>
    <script src="//code.jquery.com/ui/1.11.2/jquery-ui.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="../bower_components/bootstrap/dist/js/bootstrap.min.js"></script>

    <!-- Metis Menu Plugin JavaScript -->
    <script src="../bower_components/metisMenu/dist/metisMenu.min.js"></script>

    <!-- Custom Theme JavaScript -->
    <script src="../js/sb-admin-2.js"></script>

    <!-- Util Javascript -->
    <script src = "../js/util.js"></script>

</body>

<script>
$(function() {
    loadPanels();    

    /*sendRequest('../php/AssessmentService.php',
            basicCallback,
            'getUndoneAssessmentsByGroupNo',
            {'groupNo' : 41});*/

    /*sendRequest('../php/AssessmentService.php',
            basicCallback,
            'getDoneAssessmentsByGroupNo',
            {'groupNo' : 41});*/

    /*sendRequest('../php/AssessmentService.php',
            basicCallback,
            'getDoneAssessmentsByReportNo',
            {'reportNo' : 31});*/

    /*sendRequest('../php/AssessmentService.php',
            basicCallback,
            'getAllAssessments');*/

    var commentText = 'The quick, brown fox jumps over a lazy dog. DJs flock by when MTV ax quiz prog. Junk MTV quiz graced by fox whelps. Bawds jog, flick quartz, vex nymphs. Waltz, bad nymph, for quick jigs vex! Fox nymphs grab quick-jived waltz. Brick quiz whangs jumpy veldt fox. Bright vixens jump; dozy fowl quack. Quick wafting zephyrs vex bold Jim. Quick zephyrs blow, vexing daft Jim. Sex-charged fop blew my junk TV quiz. How quickly daft jumping zebras vex. Two driven jocks help fax my big quiz. Quick, Baz, get my woven flax jodhpurs! "Now fax quiz Jack!" my brave ghost pled. Five quacking zephyrs jolt my wax bed. Flummoxed by job, kvetching W. zaps Iraq. Cozy sphinx waves quart jug of bad milk. A very bad quack might jinx zippy fowls. Few quips galvanized the mock jury box. Quick brown dogs jump over the lazy fox. The jay, pig, fox, zebra, and my wolves quack! Blowzy red vixens fight for a quick jump. Joaquin Phoenix was gazed by MTV for luck. A wizardâ€™s job is to vex chumps quickly in fog. Watch "Jeopardy!", Alex Trebeks fun TV quiz game. Woven silk pyjamas exchanged for blue quartz. Brawny gods just flocked up to quiz and vex him. Adjusting quiver and bow, Zompyc[1] killed the fox. My faxed joke won a pager in the cable TV quiz show. Amazingly few discotheques provide jukeboxes. My girl wove six dozen plaid jackets before she quit. Six big devils from Japan quickly forgot how to waltz. Big July earthquakes confound zany experimental vow. Foxy parsons quiz and cajole the lovably dim wiki-girl. Have a pick: twenty six letters - no forcing a jumbled quiz! Crazy Fredericka bought many very exquisite opal jewels. Sixty zippers were quickly picked from the woven jute bag. A quick';

    /*sendRequest('../php/AssessmentService.php',
            basicCallback,
            'setAssessment',
            {'reportNo' : 1,
            'groupNo' : 41,
            'structureGrade': 2,
            'strengthGrade' : 3,
            'qualityGrade' : 1.5,
            'formatGrade' : 5,
            'averageGrade' : 2.875,
            'comment' : commentText});*/

      /*sendRequest('../php/AssessmentService.php',
            basicCallback,
            'assignAssessment',
            {'groupNo' : 41,
             'reportNo' : 1});*/
});

function loadPanels(){
    var bodyText = "";
    for(var i = 0; i < 15; i++){
        bodyText += "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vestibulum tincidunt est vitae ultrices accumsan. Aliquam ornare lacus adipiscing, posuere lectus et, fringilla augue.";
    }

    var data = {title: "The Best Report",
                groupNo: 15,
                body: bodyText,
                structureGrade : 1,
                strengthGrade : 2,
                qualityGrade : 3,
                formatGrade : 4,
                overallGrade: 2.5,
                comments: bodyText}
    createPanel("report-panel", data);
    createPanel("assessed-panel", data);
    addSliders();
}

function createPanel(type, data) {
    $(".container-fluid").append('<div class="row '+type+'"> <!-- change class show and hide divs -->'+
                    '<div class="col-lg-12">'+
                        '<div class="top-panel red-border"> <!-- ADD/REMOVE panel class when necessary-->'+
                                '<div class="panel-heading show-more">'+
                                    '<span class="pull-left title"></span>'+
                                    '<span class="pull-right"><i class="fa fa-plus"></i></span>'+
                                    '<div class="clearfix"></div>'+
                                '</div>'+
                                '<div class="panel-body red-div sub-report">'+
                                    '<p></p>'+
                                '</div>'+
                                '<div class="panel-body red-div full-report">'+
                                    '<p></p>'+
                                '</div>'+
                                '<div class="panel-footer">'+
                                    '<span class="pull-left">Assess Report</span>'+
                                    '<span class="pull-right"><i class="fa fa-arrow-right"></i></span>'+
                                    '<div class="clearfix"></div>'+
                                '</div>'+
                        '</div>'+
                        '<div class="bottom-panel green-border">'+
                            '<div class="panel-heading">'+
                                '<span class="pull-left title"></span>'+
                                '<span class="pull-right"><i class="fa fa-plus"></i></span>'+
                                '<div class="clearfix"></div>'+
                            '</div>'+
                            '<div class="panel-body green-div assessment-form">'+
                                '<div class="row" id="structureGrade">'+
                                    '<div class="col-lg-5 col-md-4 col-sm-12 col-xs-12 col-lg-offset-2">'+
                                        '<p>'+
                                          '<label class="col-lg-5" for="rank">Structure Rank:</label>'+
                                          '<input type="text" id="rank" readonly style="border:0; color:#f6931f; font-weight:bold;">'+
                                        '</p>'+
                                    '</div>'+
                                    '<div class="col-lg-2 col-md-4  col-sm-6 col-xs-8" id="slider"></div>'+
                                '</div>'+
                                '<div class="row" id="strengthGrade">'+
                                    '<div class="col-lg-5 col-md-4 col-sm-12 col-xs-12 col-lg-offset-2">'+
                                        '<p>'+
                                          '<label class="col-lg-5" for="rank">Strength Rank:</label>'+
                                          '<input type="text" id="rank" readonly style="border:0; color:#f6931f; font-weight:bold;">'+
                                        '</p>'+
                                    '</div>'+
                                    '<div class="col-lg-2 col-md-4  col-sm-6 col-xs-8" id="slider"></div>'+
                                '</div>'+
                                '<div class="row" id="formatGrade">'+
                                    '<div class="col-lg-5 col-md-4 col-sm-12 col-xs-12 col-lg-offset-2">'+
                                        '<p>'+
                                          '<label class="col-lg-5" for="rank">Format Rank:</label>'+
                                          '<input type="text" id="rank" readonly style="border:0; color:#f6931f; font-weight:bold;">'+
                                        '</p>'+
                                    '</div>'+
                                    '<div class="col-lg-2 col-md-4  col-sm-6 col-xs-8" id="slider"></div>'+
                                '</div>'+
                                '<div class="row" id="qualityGrade">'+
                                    '<div class="col-lg-5 col-md-4 col-sm-12 col-xs-12 col-lg-offset-2">'+
                                        '<p>'+
                                          '<label class="col-lg-5" for="rank">Quality Rank:</label>'+
                                          '<input type="text" id="rank" readonly style="border:0; color:#f6931f; font-weight:bold;">'+
                                        '</p>'+
                                    '</div>'+
                                    '<div class="col-lg-2 col-md-4  col-sm-6 col-xs-8" id="slider"></div>'+
                                '</div>'+
                                '<div class="row">'+
                                    '<div class="form-group col-lg-8 col-lg-offset-2">'+
                                            '<label class="col-lg-5">Comments:</label>'+
                                            '<textarea class="form-control" rows="10"></textarea>'+
                                    '</div>'+
                                '</div>'+
                            '</div>'+
                            '<div class="panel-body green-div sub-assessment">'+
                                '<p></p>'+
                            '</div>'+
                            '<div class="panel-body green-div full-assessment">'+
                                '<p></p>'+
                            '</div>'+
                            '<div class="panel-footer view-switch">'+
                                '<span class="pull-left grade"></span>'+
                                '<span class="pull-right"><i class="fa fa-exchange"></i></span>'+
                                '<div class="clearfix"></div>'+
                            '</div>'+
                            '<div class="panel-footer save">'+
                                '<span class="pull-left">Save Assessment</span>'+
                                '<span class="pull-right"><i class="fa fa-floppy-o"></i></span>'+
                                '<div class="clearfix"></div>'+
                            '</div>'+
                        '</div>'+
                    '</div>'+
                    '<!-- /.col-lg-12 -->'+
                '</div>'+
                '<!-- /.row -->');

    // SET ALL PANEL EVENTS (SWITCHING BETWEEN VIEWS)
    $(".container-fluid ."+type).last().find(".top-panel .panel-heading").click(showMore);
    $(".container-fluid ."+type).last().find(".top-panel .panel-footer").click(function(){
        changePanel($(this).parent().parent().parent(), "assessing-panel", data);
    });
    $(".container-fluid ."+type).last().find(".bottom-panel .panel-heading").click(showMore);
    $(".container-fluid ."+type).last().find(".bottom-panel .view-switch").click(function(){
        if($(this).parent().parent().parent().hasClass("assessed-panel")){
            changePanel($(this).parent().parent().parent(), "report-assess-panel", data);
        } else {
            changePanel($(this).parent().parent().parent(), "assessed-panel", data);
        }
    });
    $(".container-fluid ."+type).last().find(".bottom-panel .save").click(function(){
        changePanel($(this).parent().parent().parent(), "assessed-panel", data);
    });

    changePanel($(".container-fluid ."+type).last(), type, data);
}

function changePanel($divToChange, newType, data){
    //GET CURRENT CLASS REMOVE THE CLASS SO IT CAN BE CHANGED
    var currType = "";
    if($divToChange.hasClass("report-panel")){
        currType = "report-panel";
        $divToChange.removeClass("report-panel");
    } else if($divToChange.hasClass("assessing-panel")) {
        currType = "assessing-panel";
        $divToChange.removeClass("assessing-panel");
    } else if($divToChange.hasClass("assessed-panel")) {
        currType = "assessed-panel";
        $divToChange.removeClass("assessed-panel");
    } else if($divToChange.hasClass("report-assess-panel")) {
        currType = "report-assess-panel";
        $divToChange.removeClass("report-assess-panel");
    }

    $divToChange.find(".top-panel").removeClass("panel");
    $divToChange.find(".top-panel").show();
    $divToChange.find(".top-panel .panel-heading").find("i").removeClass("fa-minus").addClass("fa-plus");
    $divToChange.find(".top-panel .panel-heading").show();
    $divToChange.find(".top-panel .sub-report").show();
    $divToChange.find(".top-panel .full-report").hide();
    $divToChange.find(".top-panel .panel-footer").show();

    $divToChange.find(".bottom-panel").removeClass("panel");
    $divToChange.find(".bottom-panel").show();
    $divToChange.find(".bottom-panel .panel-heading").find("i").removeClass("fa-minus").addClass("fa-plus");
    $divToChange.find(".bottom-panel .panel-heading").show();
    $divToChange.find(".bottom-panel .assessment-form").show();
    $divToChange.find(".bottom-panel .sub-assessment").show();
    $divToChange.find(".bottom-panel .full-assessment").hide();
    $divToChange.find(".bottom-panel .view-switch").show();
    $divToChange.find(".bottom-panel .save").show();

    switch(newType) {
        case "report-panel":
            if(!$divToChange.find(".top-panel .panel-heading .title").text().trim() 
            || !$divToChange.find(".top-panel .sub-report p").text().trim() 
            || !$divToChange.find(".top-panel .full-report p").text().trim()){

                $divToChange.find(".top-panel .panel-heading .title").text(data.title +" - "+ data.groupNo);
                $divToChange.find(".top-panel .sub-report p").text(data.body.substring(0,450));
                $divToChange.find(".top-panel .full-report p").text(data.body);
            }

            $divToChange.addClass("report-panel");

            $divToChange.find(".bottom-panel .panel-heading").hide();
            $divToChange.find(".bottom-panel .assessment-form").hide();
            $divToChange.find(".bottom-panel .sub-assessment").hide();
            $divToChange.find(".bottom-panel .view-switch").hide();
            $divToChange.find(".bottom-panel .save").hide();
            $divToChange.find(".bottom-panel").hide();
            $divToChange.find(".top-panel").addClass("panel");
            break;
        case "assessing-panel":
            $divToChange.addClass("assessing-panel");

            $divToChange.find(".top-panel .panel-footer").hide();

            $divToChange.find(".bottom-panel .panel-heading").hide();
            $divToChange.find(".bottom-panel .sub-assessment").hide();
            $divToChange.find(".bottom-panel .panel-heading").hide();
            $divToChange.find(".bottom-panel .view-switch").hide();
            break;
        case "assessed-panel":
            //NEEDS TO BE REDONE
            if(currType == "assessing-panel") {
                 var overall = ($divToChange.find("#structureGrade #slider").slider( "value" ) +
                                $divToChange.find("#strengthGrade #slider").slider( "value" ) +
                                $divToChange.find("#formatGrade #slider").slider( "value" ) +
                                $divToChange.find("#qualityGrade #slider").slider( "value" ) ) / 4;
                 var comments = $divToChange.find(".bottom-panel textarea").val();

                $divToChange.find(".top-panel .panel-heading .title").text(data.title +" - "+ data.groupNo);
                $divToChange.find(".top-panel .sub-report p").text(data.body.substring(0,450));
                $divToChange.find(".top-panel .full-report p").text(data.body);

                $divToChange.find(".bottom-panel .panel-heading .title").text(data.title +" - "+ data.groupNo);
                $divToChange.find(".bottom-panel .sub-assessment p").text(comments.substring(0,450));
                $divToChange.find(".bottom-panel .full-assessment p").text(comments);
                $divToChange.find(".bottom-panel .view-switch .grade").text("Overall Grade: " + overall);
            } else {
                if(!$divToChange.find(".bottom-panel .panel-heading .title").text().trim()){
                    $divToChange.find(".top-panel .panel-heading .title").text(data.title +" - "+ data.groupNo);
                    $divToChange.find(".top-panel .sub-report p").text(data.body.substring(0,450));
                    $divToChange.find(".top-panel .full-report p").text(data.body);

                    $divToChange.find(".bottom-panel .panel-heading .title").text(data.title +" - "+ data.groupNo);
                    $divToChange.find(".bottom-panel .sub-assessment p").text(data.comments.substring(0,450));
                    $divToChange.find(".bottom-panel .full-assessment p").text(data.comments);
                    $divToChange.find(".bottom-panel .view-switch .grade").text("Overall Grade: " + data.overallGrade);
                }
                
            }

            $divToChange.addClass("assessed-panel");

            $divToChange.find(".top-panel .panel-heading").hide();
            $divToChange.find(".top-panel .sub-report").hide();
            $divToChange.find(".top-panel .panel-footer").hide();
            $divToChange.find(".top-panel").hide();

            $divToChange.find(".bottom-panel .assessment-form").hide();
            $divToChange.find(".bottom-panel .save").hide();
            $divToChange.find(".bottom-panel").addClass("panel");
            break;
        case "report-assess-panel":
            $divToChange.addClass("report-assess-panel");

            $divToChange.find(".top-panel .panel-footer").hide();

            $divToChange.find(".bottom-panel .panel-heading").hide();
            $divToChange.find(".bottom-panel .assessment-form").hide();
            $divToChange.find(".bottom-panel .save").hide();
            break;
        default:
            console.log('Invalid div removed');
            $divToChange.remove();
            break;
    }
}

var showMore = function(){
    if($(this).find("i").hasClass("fa-plus")){
        $(this).parent().parent().find(".sub-report").hide();
        $(this).parent().parent().find(".full-report").show();
        $(this).parent().parent().find(".sub-assessment").hide();
        $(this).parent().parent().find(".full-assessment").show();
        $(this).find("i").removeClass("fa-plus").addClass("fa-minus");
   } else {
        $(this).parent().parent().find(".sub-report").show();
        $(this).parent().parent().find(".full-report").hide();
        $(this).parent().parent().find(".sub-assessment").show();
        $(this).parent().parent().find(".full-assessment").hide();
        $(this).find("i").removeClass("fa-minus").addClass("fa-plus");
   }
}

function addSliders(){
    var sliders = ["#structureGrade","#strengthGrade","#formatGrade","#qualityGrade"];
    $.each(sliders, function(i, sliderID) {
        $( sliderID + " #slider" ).slider({
          value:1,
          min: 1,
          max: 5,
          step: .5,
          slide: function( event, ui ) {
            $( sliderID + " #rank" ).val( ui.value );
          }
        });
        $( sliderID + " #rank" ).val($( sliderID + " #slider" ).slider( "value" ) );
    });
}
</script>

</html>
