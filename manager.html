<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>jQuery UI Droppable - Simple photo manager</title>
  <link rel="shortcut icon" href="media/kuzco_cursed.png">
  
  <!-- Bootstrap Core CSS -->
  <link rel="stylesheet" href="//code.jquery.com/ui/1.11.2/themes/smoothness/jquery-ui.css">
  <link href="bower_components/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- MetisMenu CSS -->
  <link href="bower_components/metisMenu/dist/metisMenu.min.css" rel="stylesheet">

  <!-- Custom CSS -->
  <link href="css/sb-admin-2.css" rel="stylesheet">

  <!-- Custom Fonts -->
  <link href="bower_components/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">

  <link href="css/main.css" rel="stylesheet">

  <!-- jQuery -->
  <script src="//code.jquery.com/jquery-1.10.2.js"></script>
  <script src="//code.jquery.com/ui/1.11.2/jquery-ui.js"></script>

  <!-- Bootstrap Core JavaScript -->
  <script src="bower_components/bootstrap/dist/js/bootstrap.min.js"></script>

  <!-- Metis Menu Plugin JavaScript -->
  <script src="bower_components/metisMenu/dist/metisMenu.min.js"></script>

  <!-- Custom Theme JavaScript -->
  <script src="js/sb-admin-2.js"></script>
  <style>
  #gallery { float: left; width: 65%; min-height: 12em; }
  .gallery.custom-state-active { background: #eee; }
  .gallery li { float: left; width: 96px; padding: 0.4em; margin: 0 0.4em 0.4em 0; text-align: center; }
  .gallery li h5 { margin: 0 0 0.4em; cursor: move; }
  .gallery li a { float: right; }
  .gallery li a.ui-icon-zoomin { float: left; }
  .gallery li img { width: 100%; cursor: move; }
 
  #trash1 { float: left; width: 32%; min-height: 18em; padding: 1%; }
  #trash2 { float: left; width: 32%; min-height: 18em; padding: 1%; }
  #trash h4 { line-height: 16px; margin: 0 0 0.4em; }
  #trash h4 .ui-icon { float: left; }
  #trash .gallery h5 { display: none; }

  .scroll-pane { overflow: auto; width: 99%; float:left; }
  .scroll-content { width: 2440px; float: left; }
  .scroll-content-item { width: 100px; height: 100px; float: left; margin: 10px; font-size: .7em; text-align: center; }
  .scroll-bar-wrap { clear: left; padding: 0 4px 0 2px; margin: 0 -1px -1px -1px; }
  .scroll-bar-wrap .ui-slider { background: none; border:0; height: 2em; margin: 0 auto;  }
  .scroll-bar-wrap .ui-handle-helper-parent { position: relative; width: 100%; height: 100%; margin: 0 auto; }
  .scroll-bar-wrap .ui-slider-handle { top:.2em; height: 1.5em; }
  .scroll-bar-wrap .ui-slider-handle .ui-icon { margin: -8px auto 0; position: relative; top: 50%; }
  #sortable1, #sortable2 {
    border: 1px solid #eee;
    width: 142px;
    min-height: 20px;
    list-style-type: none;
    margin: 0;
    padding: 5px 0 0 0;
    float: left;
    margin-right: 10px;
  }
  #sortable1 li, #sortable2 li {
    margin: 0 5px 5px 5px;
    padding: 5px;
    font-size: 1.2em;
    width: 120px;
  }
  </style>
  <script>
  $(function() {
    
    var list = ["One","One","One",
    "Two","Two","Two",
    "Three","Three","Three",
    "Four","Four","Four",
    "Five","Five","Five",
    "Six","Six","Six",
    "Seven","Seven","Seven",
    "Eight","Eight","Eight",
    "Nine","Nine","Nine",
    "Ten","Ten","Ten",
    "Eleven","Eleven","Eleven",
    "Twelve","Twelve","Twelve",
    "Thirteen","Thirteen","Thirteen",
    "Fourteen","Fourteen","Fourteen",
    "Fifteen","Fifteen","Fifteen",
    "Sixteen","Sixteen","Sixteen",
    "Seventeen","Seventeen","Seventeen",
    "Eighteen","Eighteen","Eighteen",
    "Nineteen","Nineteen","Nineteen",
    "Twenty","Twenty","Twenty"];

    var count = 0;
    $.each(list, function(i, data) {
      if(i%3 == 0){
        $(".scroll-pane .scroll-content").append("<div id='g"+count+"' class='draggable scroll-content-item ui-widget-header'></div>");
        $(".scroll-pane .scroll-content #g"+count+"").append("<div class='title'> Group "+(count+1)+"</div>");
        $(".scroll-pane .scroll-content #g"+count+"").append("<ul class='smallUpperMargin groupWrap'></ul>");
        count++;
      }

      $(".scroll-pane .scroll-content #g"+(count-1)+" ul").append("<li class=c"+(i%3+1)+">"+data+"</li>");
    });

    var curr = null, 
      prev = null,
      $leftManager = null,
      $rightManager = null;
    $( "#sortable1, #sortable2" ).sortable({
      connectWith: ".connectedSortable",
      update: function (event, ui) {
        prev = curr == null ? null : curr;
        curr = $(this);
        if(prev != null && prev.attr("id") != curr.attr("id")){

          $leftManager.find("ul").empty();
          $(("#sortable2 li")).each(function(i, val) {
            $leftManager.find("ul").append("<li class=c"+(i+1)+">"+$(val).text()+"</li>");
          });

          $rightManager.find("ul").empty();
          $(("#sortable1 li")).each(function(i, val) {
            $rightManager.find("ul").append("<li class=c"+(i+1)+">"+$(val).text()+"</li>");
          });
        }
      }
    }).disableSelection()/*.on("click", function() {
      // First figure out which list the clicked element is NOT in...
      var otherUL = $("#sortable1, #sortable2").not($(this).closest("ul"));
      var li = $(this).closest("li");

      console.log(otherUL);
      console.log(li);
      // Move the li to the other list. prependTo() can also be used instead of appendTo().
      li.detach().appendTo(otherUL);
    });*/

    /* DRAGGABLE */
    // there's the gallery and the trash
    var $gallery = $( "#gallery" ),
      $trash1 = $( "#trash1" ),
      $trash2 = $( "#trash2" );
 
    $(".draggable").draggable({
      container: "#fullContainer",
      revert: "invalid",
      containment: "document",
      helper: "clone",
      cursor: "move"
      });

    // let the gallery items be draggable
    $( "li", $gallery , ".draggable").draggable({
      cancel: "a.ui-icon", // clicking an icon won't initiate dragging
      revert: "invalid", // when not dropped, the item will revert back to its initial position
      containment: "document",
      helper: "clone",
      cursor: "move"
    });
 
    // let the trash be droppable, accepting the gallery items
    $("#trash1, #trash2").droppable({
      accept: function(item) {
        if(item.attr("class").split(" ")[0] == "draggable"){
          if($rightManager && $leftManager){
            if($(this).attr("id") == "trash1"){
              return $rightManager.find("li").length == 3;
            } else {
              return $leftManager.find("li").length == 3;
            } 
          } else {
            return true;
          }
        }else {
          return false;
        }
      },
      hoverClass: "ui-state-active",
      drop: function( event, ui ) {
        replaceGroup( ui.draggable, $(this) );
      }
    });
 
    // let the gallery be droppable as well, accepting items from the trash
    $gallery.droppable({
      accept: "#trash li",
      activeClass: "custom-state-active",
      drop: function( event, ui ) {
        recycleImage( ui.draggable );
      }
    });
 
    // image deletion function
    var recycle_icon = "<a href='link/to/recycle/script/when/we/have/js/off' title='Recycle this image' class='ui-icon ui-icon-refresh'>Recycle image</a>";
    function replaceGroup( $item, $unit ) {
      var $temp = $item.clone();

      if($unit.attr("id") == "trash1"){
        $rightManager = $item;
      } else {
        $leftManager = $item;
      }

      $unit.find("ul").empty();
      $unit.find(".title").text($temp.find(".title").text());
      $unit.find("ul").append("<li class='ui-state-default c1'>"+$temp.find(".c1").text()+"</li>");
      $unit.find("ul").append("<li class='ui-state-default c2'>"+$temp.find(".c2").text()+"</li>");
      $unit.find("ul").append("<li class='ui-state-default c3'>"+$temp.find(".c3").text()+"</li>");
    }
 
    // image recycle function
    var trash_icon = "<a href='link/to/trash/script/when/we/have/js/off' title='Delete this image' class='ui-icon ui-icon-trash'>Delete image</a>";
    function recycleImage( $item ) {
      $item.fadeOut(function() {
        $item
          .find( "a.ui-icon-refresh" )
            .remove()
          .end()
          .css( "width", "96px")
          .append( trash_icon )
          .find( "img" )
            .css( "height", "72px" )
          .end()
          .appendTo( $gallery )
          .fadeIn();
      });
    }
 
    // image preview function, demonstrating the ui.dialog used as a modal window
    function viewLargerImage( $link ) {
      var src = $link.attr( "href" ),
        title = $link.siblings( "img" ).attr( "alt" ),
        $modal = $( "img[src$='" + src + "']" );
 
      if ( $modal.length ) {
        $modal.dialog( "open" );
      } else {
        var img = $( "<img alt='" + title + "' width='384' height='288' style='display: none; padding: 8px;' />" )
          .attr( "src", src ).appendTo( "body" );
        setTimeout(function() {
          img.dialog({
            title: title,
            width: 400,
            modal: true
          });
        }, 1 );
      }
    }
 
    // resolve the icons behavior with event delegation
    $( "ul.gallery > li" ).click(function( event ) {
      var $item = $( this ),
        $target = $( event.target );
 
      if ( $target.is( "a.ui-icon-trash" ) ) {
        replaceGroup( $item );
      } else if ( $target.is( "a.ui-icon-zoomin" ) ) {
        viewLargerImage( $target );
      } else if ( $target.is( "a.ui-icon-refresh" ) ) {
        recycleImage( $item );
      }
      return false;
    });


    /* SCROLLBAR */

    //scrollpane parts
    var scrollPane = $( ".scroll-pane" ),
      scrollContent = $( ".scroll-content" );
 
    //build slider
    var scrollbar = $( ".scroll-bar" ).slider({
      slide: function( event, ui ) {
        if ( scrollContent.width() > scrollPane.width() ) {
          scrollContent.css( "margin-left", Math.round(
            ui.value / 100 * ( scrollPane.width() - scrollContent.width() )
          ) + "px" );
        } else {
          scrollContent.css( "margin-left", 0 );
        }
      }
    });
 
    //append icon to handle
    var handleHelper = scrollbar.find( ".ui-slider-handle" )
    .mousedown(function() {
      scrollbar.width( handleHelper.width() );
    })
    .mouseup(function() {
      scrollbar.width( "100%" );
    })
    .append( "<span class='ui-icon ui-icon-grip-dotted-vertical'></span>" )
    .wrap( "<div class='ui-handle-helper-parent'></div>" ).parent();
 
    //change overflow to hidden now that slider handles the scrolling
    scrollPane.css( "overflow", "hidden" );
 
    //size scrollbar and handle proportionally to scroll distance
    function sizeScrollbar() {
      var remainder = scrollContent.width() - scrollPane.width();
      var proportion = remainder / scrollContent.width();
      var handleSize = scrollPane.width() - ( proportion * scrollPane.width() );
      scrollbar.find( ".ui-slider-handle" ).css({
        width: handleSize,
        "margin-left": -handleSize / 2
      });
      handleHelper.width( "" ).width( scrollbar.width() - handleSize );
    }
 
    //reset slider value based on scroll content position
    function resetValue() {
      var remainder = scrollPane.width() - scrollContent.width();
      var leftVal = scrollContent.css( "margin-left" ) === "auto" ? 0 :
        parseInt( scrollContent.css( "margin-left" ) );
      var percentage = Math.round( leftVal / remainder * 100 );
      scrollbar.slider( "value", percentage );
    }
 
    //if the slider is 100% and window gets larger, reveal content
    function reflowContent() {
        var showing = scrollContent.width() + parseInt( scrollContent.css( "margin-left" ), 10 );
        var gap = scrollPane.width() - showing;
        if ( gap > 0 ) {
          scrollContent.css( "margin-left", parseInt( scrollContent.css( "margin-left" ), 10 ) + gap );
        }
    }
 
    //change handle position on window resize
    $( window ).resize(function() {
      resetValue();
      sizeScrollbar();
      reflowContent();
    });
    //init scrollbar size
    setTimeout( sizeScrollbar, 10 );//safari wants a timeout
  });
  </script>
</head>
<body>
 
<div id="fullContainer">
  <p>Made this because it definitely would have been to hard to explain this idea. Though I ended up explaining the other half of it in this text.</p>
  <p>Just drag stuff the groups 1-20 into those bigger boxes. You can now compare two groups and drag members between each group. The groups slider is kept up to date as you drag in the bigger boxes. If you do not have three people in each group, it will not let you change groups, but as soon as you do you're good to go. I was thinking of adding couple buttons as well: switch view button and a random assign button. </p>
  </p> The switch view button would change the left box to a list of students, clear all the grouping in the slider and allow you to move users to the right box (being their group) once the right box has three people, the box is then sent to the slider and the next empty box is presented (hope that makes sense). I didn't implement it because it would be qutie a bit of work, but definitely do able. Then of course if they press "switch view" again, it will take them back to this view. </p>
  <p> The "random assign" button would be for if at any point the admin gets lazy he can random assign and groupings will be made for them and presented in the slider (the bigger boxes will be empty).</p>
  <p>Also on top of the bigger boxes there can be search bars where you can search by text and it will display the group which the text is found in.</p>
  <p>This obviously could look better.</p>
  <p>Where I got inspiration/code <a href="http://jqueryui.com/droppable/#photo-manager">Drop w/ event</a> <a href="http://jqueryui.com/slider/#side-scroll">Scroll w/ div</a> <a href="http://jqueryui.com/sortable/#connect-lists">Sorting</a> </p>
  <div class="scroll-pane ui-widget ui-widget-header ui-corner-all">
    <div class="scroll-content">
    </div>
    <div class="scroll-bar-wrap ui-widget-content ui-corner-bottom">
      <div class="scroll-bar"></div>
    </div>
  </div>

  <div class="ui-widget ui-helper-clearfix">
    <div class ="row">
      <div id="trash1" class="upperMargin ui-widget-content ui-state-default">
        <div class="ui-widget-header title">No Group Selected</div>
        <ul id="sortable1" class="connectedSortable">
        </ul>
      </div>
      <div id="trash2" class="upperMargin ui-widget-content ui-state-default">
        <div class="ui-widget-header title">No Group Selected</div>
        <ul id="sortable2" class="connectedSortable">
        </ul>
      </div>
      <div id="group3" class="upperMargin ui-widget-content ui-state-default">
        <div class="ui-widget-header title">No Group Selected</div>
        <ul id="sortable1" class="connectedSortable">
        </ul>
      </div>
      <div id="group4" class="upperMargin ui-widget-content ui-state-default">
        <div class="ui-widget-header title">No Group Selected</div>
        <ul id="sortable1" class="connectedSortable">
        </ul>
      </div>
      <div id="group5" class="upperMargin ui-widget-content ui-state-default">
        <div class="ui-widget-header title">No Group Selected</div>
        <ul id="sortable1" class="connectedSortable">
        </ul>
      </div>
      <div id="group6" class="upperMargin ui-widget-content ui-state-default">
        <div class="ui-widget-header title">No Group Selected</div>
        <ul id="sortable1" class="connectedSortable">
        </ul>
      </div>
      <div id="group7" class="upperMargin ui-widget-content ui-state-default">
        <div class="ui-widget-header title">No Group Selected</div>
        <ul id="sortable1" class="connectedSortable">
        </ul>
      </div>
      <div id="group8" class="upperMargin ui-widget-content ui-state-default">
        <div class="ui-widget-header title">No Group Selected</div>
        <ul id="sortable1" class="connectedSortable">
        </ul>
      </div>
      <div id="group9" class="upperMargin ui-widget-content ui-state-default">
        <div class="ui-widget-header title">No Group Selected</div>
        <ul id="sortable1" class="connectedSortable">
        </ul>
      </div>
      <div id="group10" class="upperMargin ui-widget-content ui-state-default">
        <div class="ui-widget-header title">No Group Selected</div>
        <ul id="sortable1" class="connectedSortable">
        </ul>
      </div>
      <div id="group11" class="upperMargin ui-widget-content ui-state-default">
        <div class="ui-widget-header title">No Group Selected</div>
        <ul id="sortable1" class="connectedSortable">
        </ul>
      </div>
      <div id="group12" class="upperMargin ui-widget-content ui-state-default">
        <div class="ui-widget-header title">No Group Selected</div>
        <ul id="sortable1" class="connectedSortable">
        </ul>
      </div>
      <div id="group13" class="upperMargin ui-widget-content ui-state-default">
        <div class="ui-widget-header title">No Group Selected</div>
        <ul id="sortable1" class="connectedSortable">
        </ul>
      </div>
      <div id="group14" class="upperMargin ui-widget-content ui-state-default">
        <div class="ui-widget-header title">No Group Selected</div>
        <ul id="sortable1" class="connectedSortable">
        </ul>
      </div>
      <div id="group15" class="upperMargin ui-widget-content ui-state-default">
        <div class="ui-widget-header title">No Group Selected</div>
        <ul id="sortable1" class="connectedSortable">
        </ul>
      </div>
      <div id="group16" class="upperMargin ui-widget-content ui-state-default">
        <div class="ui-widget-header title">No Group Selected</div>
        <ul id="sortable1" class="connectedSortable">
        </ul>
      </div>
      <div id="group17" class="upperMargin ui-widget-content ui-state-default">
        <div class="ui-widget-header title">No Group Selected</div>
        <ul id="sortable1" class="connectedSortable">
        </ul>
      </div>
      <div id="group18" class="upperMargin ui-widget-content ui-state-default">
        <div class="ui-widget-header title">No Group Selected</div>
        <ul id="sortable1" class="connectedSortable">
        </ul>
      </div>
      <div id="group19" class="upperMargin ui-widget-content ui-state-default">
        <div class="ui-widget-header title">No Group Selected</div>
        <ul id="sortable1" class="connectedSortable">
        </ul>
      </div>
      <div id="group20" class="upperMargin ui-widget-content ui-state-default">
        <div class="ui-widget-header title">No Group Selected</div>
        <ul id="sortable1" class="connectedSortable">
        </ul>
      </div>
    </div>
  </div>
</div>

</body>
</html>