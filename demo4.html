<!doctype html>
<html>
	<head>
		<title>Review Llama</title>
		<link rel = "stylesheet" href="css/main.css">
		
		<!-- Latest compiled and minified CSS -->
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">

		<!-- Optional theme -->
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap-theme.min.css">
	</head>
	<body>
		<div id = "header">
			<h1>Review Llama - Slowly breaking it down</h1>
		</div>

		<!-- USER ADD/EDIT -->
		<div class = "upperMargin col-sm-12">
		<h3>User Add/Edit</h3>
		<form class="col-sm-4">
			<div class="form-group">
				<label for="userListU">User List (leave on Add to add or select from the list to edit)</label>
				<select class="form-control" id="userListU">
				  <option>Add</option>
				</select>
			</div>
			<div class="form-group">
		    	<label for="usernameU">Username</label>
		    	<input type="text" class="form-control" id="usernameU" placeholder="Enter username">
		    </div>
		    <div class="form-group">
			    <label for="passwordU">Password</label>
			    <input type="password" class="form-control" id="passwordU" placeholder="Password">
			</div>
			<div class="form-group">
		    	<label for="fnameU">First Name</label>
		    	<input type="text" class="form-control" id="fnameU" placeholder="Enter first name">
		    </div>
		    <div class="form-group">
		    	<label for="lnameU">Last Name</label>
		    	<input type="text" class="form-control" id="lnameU" placeholder="Enter last name">
		    </div>
		    <div class="form-group">
				<label for="userSel">User Type</label>
				<label class="radio-inline">
				  <input type="radio" name="userSel" id="userSel1" value="student"> Student
				</label>
				<label class="radio-inline">
				  <input type="radio" name="userSel" id="userSel2" value="admin"> Admin
				</label>
			</div>
		    <button type="button" class="btn btn-default" onclick="updateUser()">Submit</button>
		</form>
	    </div>

	    <!-- GROUP ADD/EDIT -->
	    <div class = "upperMargin col-sm-12">
		<h3 class = "upperMargin ">Group Add/Edit</h3>
		<form class="col-sm-4">
			<div class="form-group">
				<label for="groupListG">Group List</label>
				<select class="form-control" id="groupListG">
				  <option>Add</option>
				</select>
			</div>
			<div class="form-group">
				<label for="adminListG">Admin List</label>
				<select class="form-control" id="adminListG">
				</select>
			</div>
			<div class="form-group">
				<label for="studentListG">Student List</label>
				<select multiple class="form-control" id="studentListG">
				</select>
			</div>
			<div class="form-group">
		    	<label for="nameG">Name</label>
		    	<input type="text" class="form-control" id="nameG" placeholder="Enter group name">
		    </div>
		    <button type="button" class="btn btn-default">Submit</button>
		</form>
	    </div>

	    <!-- REPORT ADD/EDIT -->
	    <div class = "upperMargin col-sm-12">
		<h3 class = "upperMargin ">Report Add/Edit</h3>
		<form class="col-sm-4">
			<div class="form-group">
				<label for="reportListR">Report List</label>
				<select class="form-control" id="reportListR">
				  <option>Add</option>
				</select>
			</div>
			<div class="form-group">
				<label for="groupListR">Group List</label>
				<select class="form-control" id="groupListR">
				</select>
			</div>
			<div class="form-group">
		    	<label for="titleR">Title</label>
		    	<input type="text" class="form-control" id="titleR" placeholder="Enter title">
		    </div>
		    <div class="form-group">
		    	<label for="bodyR">Body</label>
		    	<textarea type="text" class="form-control" id="bodyR" placeholder="Enter body"></textarea>
		    </div>
		    <div class="form-group">
		    	<label for="refR">References</label>
		    	<input type="text" class="form-control" id="refR" placeholder="Enter references, seperated by commas">
		    </div>
			<button type="button" class="btn btn-default">Submit</button>
		</form>
	    </div>

	    

		<div class = "col-sm-4" id="footer">You've reached end of page.</div>



		<!-- SCRIPTS -->
		<script src = "js/jquery-2.1.3.js"></script>
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>
		<script src = "js/util.js"></script>
	</body>
</html>

<!-- INITIAL LOAD SCRIPT -->
<script>
$( document ).ready(function() {
 	initialLoad();
});

var initialLoad = function () {
	//user Init
	sendRequest('php/UserServiceBasic.php',
			userInit,
			'getAllUsers');

	//group Init
	//report Init
	//assessment Init
}
</script>

<!-- USER ADD/EDIT SCRIPT -->
<script>

var userTypeSel, users, userGlobal;
$("input:radio[name=userSel]").click(function() {
	userTypeSel = $(this).val();
});

$( "#userListU" ).change(function() {
  //console.log($(this)[0].selectedIndex);
  //console.log(users[$(this)[0].selectedIndex]);

  if($(this).val() == 'Add'){
  	$('#usernameU').val('');
	$('#fnameU').val('');
	$('#lnameU').val('');
	$('#passwordU').val('');
	
	$("input:radio[id=userSel1]").prop('checked',false);
	$("input:radio[id=userSel2]").prop('checked',false);

	userTypeSel = '';

  	$("input:radio[name=userSel]").attr('disabled',false);
  } else {
	userGlobal = users[$(this)[0].selectedIndex-1];
	$('#usernameU').val(userGlobal.username);
	$('#fnameU').val(userGlobal.fName);
	$('#lnameU').val(userGlobal.lName);

    if(userGlobal.isStudent){
  	  $("input:radio[id=userSel1]").prop('checked',true);
  	  userTypeSel = 'student';
    } else if(userGlobal.isAdmin){
  	  $("input:radio[id=userSel2]").prop('checked',true);
  	  userTypeSel = 'admin';
    }

    $("input:radio[name=userSel]").attr('disabled',true);
  }
  
});

var updateUser = function () {
	var params = {'username' : $('#usernameU').val(), 
				'password' : $('#passwordU').val(),
				'type' : userTypeSel,
				'first' : $('#fnameU').val(),
				'last' : $('#lnameU').val()};
	var functionName;

	if($('#userListU').val() == 'Add'){
		functionName = 'addUser';
	} else {
		params['id'] = userGlobal.userNo;
		functionName = 'editUser';
	}
	sendRequest('php/UserServiceBasic.php',
			initialLoad,
			functionName,
			params);

	clearFields();
}

var clearFields = function () {
	/*Clear Fields*/
	$('#usernameU').val('');
	$('#fnameU').val('');
	$('#lnameU').val('');
	$('#passwordU').val('');
	$("input:radio[id=userSel1]").prop('checked',false);
	$("input:radio[id=userSel2]").prop('checked',false);
	userTypeSel = '';
  	$("input:radio[name=userSel]").attr('disabled',false);
  	$("#userListU option[value='temp']").remove();
}

var userInit = function (response) {
	var $userList = $('#userListU');
	users = [];
	$.each(response.data, function(i, user) {
				users.push(user);
				$userList.append('<option value="temp">' + user.username + '</option>');
			});
	console.log(response.status);
}

</script>

